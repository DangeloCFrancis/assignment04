---
title: "index"
author: "D'Angelo Francis; Su Yeon Seo"
format: html
---
[Assignment 4](https://georgetown.instructure.com/courses/198228/assignments/1109024)

```{r setup, message=FALSE, warning=FALSE}

# make sure to load all packages here up top. If you need to install a package, include the commented code here as well :)

library(fontawesome) # install.packages("fontawesome") - for waffle graphs
library(styler) # install.packages("styler") - check for Tidy style guide adherence
library(lintr) # install.packages("lintr") - check for Tidy style guide adherence
library(tidyverse)
library(readxl)
library(haven)
library(tidyverse)
library(patchwork) # easy combine plots
library(tigris) # direct download of shape files from US Cenus 
library(sf) # manipulate shapefiles 
library(tidycensus) # shapefiles from Census 
library(rgeoboundaries) # international boundaries 
library(ggrepel)  # install.packages("ggrepel")
library(janitor)  # install.packages("janitor")
library(ggthemes) # install.packages("ggthemes")


options(scipen=999) # no scientific notation for my plots


```

## Quick Reference Links:

I believe that we will need these links 

- [Figures](https://quarto.org/docs/authoring/figures.html)
- [Cross Reference](https://quarto.org/docs/authoring/cross-references.html)
- [Tidyverse Style Guide Packages](https://style.tidyverse.org/)
- [Urban Style Visualization Style Guide](https://urbaninstitute.github.io/r-at-urban/graphics-guide.html)

Research Question: What is the relationship between household income and fertility among Koreans by province?

## Graph 1 - 

```{r graph 1, message=FALSE, warning=false}

# getting geospatial data prepped

rok <- geoboundaries(
  country = "Republic of Korea",
  adm_lvl = "adm1")

rok_cities <- 
  read_sf("data/cities.geojson") |>
  clean_names() |>
  filter(ctry == "South Korea")

# bringing in Korean GRDP data source , cleaning data up

rok_gdp_by_province <-
  read_excel("data/Korean GRDP Wikipedia Excel import.xlsx") |>
  clean_names() |>
  mutate(region = case_when(
    region == "Gangwon Province, South Korea" ~ "Gangwon",
    region == "Gyeonggi Province" ~ "Gyeonggi",
    region == "Jeju Province" ~ "Jeju",
    region == "North Chungcheong Province" ~ "North Chungcheong",
    region == "North Gyeongsang Province" ~ "North Gyeongsang",
    region == "North Jeolla Province" ~ "North Jeolla",
    region == "South Chungcheong Province" ~ "South Chungcheong",
    region == "South Gyeongsang Province" ~ "South Gyeongsang",
    region == "South Jeolla Province" ~ "South Jeolla",
    .default = region
  )
  ) |> 
  rename(shapeName = region)

rok_gdp_shapefile <- 
  full_join(rok, rok_gdp_by_province, by = join_by(shapeName)) |>
  st_as_sf()

# bringing in fertility data source , cleaning data up

rok_fertility_province <- 
  read_csv("data/Agespecific_Fertility_Rate_Province__20241008012056.csv") |>
  clean_names() |>
  pivot_longer(
    cols = starts_with("x", ignore.case = TRUE),
    names_to = "year",
    values_to = "fertility_rate"
    ) |>
  rename(shapeName = by_province_1 , age = by_age_1) |>
  select(-by_variant_1) |>
  filter(shapeName != "Whole country", age == "TFR", year == "x2022") |>
  mutate(shapeName = case_when(
    shapeName == "Chungcheongbuk-do" ~ "North Chungcheong",
    shapeName == "Chungcheongnam-do" ~ "South Chungcheong",
    shapeName == "Jeollabuk-do" ~ "North Jeolla",
    shapeName == "Jeollanam-do" ~ "South Jeolla",
    shapeName == "Gyeongsangbuk-do" ~ "North Gyeongsang",
    shapeName == "Gyeongsangnam-do" ~ "South Gyeongsang",
    shapeName == "Jeju-do" ~ "Jeju",
    shapeName == "Gangwon-do" ~ "Gangwon",
    shapeName == "Gyeonggi-do" ~ "Gyeonggi",
    .default = shapeName
    )
  ) 

rok_fertility_shapefile <- 
  full_join(rok, rok_fertility_province, by = join_by(shapeName)) |>
  st_as_sf()

# plot code

# need to add labs.....

korea_fertility_plot <-
  ggplot() + 
  geom_sf(data = rok_fertility_shapefile, aes(fill = fertility_rate)) +
  scale_fill_gradient(
    name = "Total Fertility Rate \n Number of Children",
    low = "#fff",
    high = "#0F64CD"
  ) + 
  theme(
    panel.background = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank()
  ) + 
  geom_sf_text(stat = "sf_coordinates")

# save for later, need to convert observations into numeric for gradient fill...

korea_gdrp_plot <-
  ggplot() + 
  geom_sf(data = rok_gdp_shapefile, aes(fill = gdrp)) +
  scale_fill_gradient(
    name = "Total Fertility Rate \n Number of Children",
    low = "#fff",
    high = "#0F64CD"
  ) + 
  theme(
    panel.background = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank()
  ) + 
  geom_sf_text(stat = "sf_coordinates")

korea_fertility_plot
```

**MAKE SURE TO COMMIT AFTER FINSIHING**

\pagebreak

## Graph 2 - 

Data Source: []() - remember to add to repo

```{r graph 2}

# brining in global gdp data , cleaning up

gdp_2023 <- 
  read_excel("gdp_2023.xls") |>
  clean_names() # from janitor() package 

gdp_2023 <- 
  gdp_2023 |>
  pivot_longer(
    cols = starts_with("x", ignore.case = TRUE),
    names_to = "year",
    values_to = "gdp",
    values_drop_na = TRUE
    ) |>
  select(-indicator_code) # not needed 


```

**MAKE SURE TO COMMIT AFTER FINSIHING**

\pagebreak

## Graph 3 -

Data Source: []() - remember to add to repo

```{r}


```

**MAKE SURE TO COMMIT AFTER FINSIHING**

## Graph 4 - 

Data Source: []() - remember to add to repo 

```{r}


```

**MAKE SURE TO COMMIT AFTER FINSIHING**

\pagebreak 
